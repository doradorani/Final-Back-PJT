<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.office.agijagi_back.Mapper.ICommunityMapper">

    <insert id="insertNewPost" parameterType="PostDto">
        INSERT INTO post (imgs_path, post_text, user_mail, reg_date, mod_date)
        VALUES (
                   #{imgs_path},
                   #{post_text},
                   #{user_mail},
                   NOW(),
                   NOW()
               )
    </insert>

    <select id="selectAllPosts" parameterType="Integer" resultType="PostDto">
        SELECT post.*, user.nickname, user.img
        FROM post
        INNER JOIN user
        ON post.user_mail = user.email
        where post.status = 1
        ORDER BY no DESC
        LIMIT 5
    </select>

    <select id="selectDetailPost" parameterType="Integer" resultType="PostDto">
        SELECT post.*, user.nickname, user.img
        FROM post
                 INNER JOIN user
                            ON post.user_mail = user.email
        where post.status = 1 and post.no = #{postId}
        ORDER BY no DESC
            LIMIT 5
    </select>

    <select id="selectMyPosts" parameterType="String" resultType="PostDto">
        SELECT *
        FROM post
        WHERE status = 1
        AND user_mail = #{email}
        ORDER BY no DESC;
    </select>

</mapper>